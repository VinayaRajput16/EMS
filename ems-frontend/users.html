<!DOCTYPE html>
<html>
<body>
<h2>User Test</h2>

<button onclick="getMe()">Get My Profile</button><br><br>

<input id="newName" placeholder="new name">
<button onclick="updateMe()">Update Name</button><br><br>

<h3>Admin Only</h3>
<button onclick="listUsers()">List Users</button><br><br>

<input id="blockId" placeholder="userId to block">
<button onclick="blockUser()">Block User</button>

<pre id="out"></pre>

<script src="common.js"></script>
<script>
async function getMe() {
  const res = await fetchWithAuth('/users/me');
  out.textContent = await res.text();
}

async function updateMe() {
  const res = await fetchWithAuth('/users/me', {
    method: 'PATCH',
    body: JSON.stringify({ name: newName.value })
  });
  out.textContent = await res.text();
}

async function listUsers() {
  const res = await fetchWithAuth('/users');
  out.textContent = await res.text();
}

async function blockUser() {
  const res = await fetchWithAuth(`/users/${blockId.value}/block`, {
    method: 'PATCH'
  });
  out.textContent = await res.text();
}
</script>
</body>
</html>
